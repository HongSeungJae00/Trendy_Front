#!/bin/bash

LOG_FILE="/home/ec2-user/deployment.log"
NODE_MODULES_DIR="/home/ec2-user/Trendy_Front/node_modules"

echo "====== START: remove_node_modules.sh ======" >> "$LOG_FILE"
echo "$(date): Removing existing node_modules before deployment..." >> "$LOG_FILE"

if [ -d "$NODE_MODULES_DIR" ]; then
  sudo rm -rf "$NODE_MODULES_DIR"
  if [ $? -eq 0 ]; then
    echo "$(date): Successfully removed node_modules." >> "$LOG_FILE"
  else
    echo "$(date): Failed to remove node_modules. Check permissions." >> "$LOG_FILE"
    exit 1
  fi
else
  echo "$(date): node_modules directory does not exist, skipping." >> "$LOG_FILE"
fi

echo "====== END: remove_node_modules.sh ======" >> "$LOG_FILE"
exit 0
